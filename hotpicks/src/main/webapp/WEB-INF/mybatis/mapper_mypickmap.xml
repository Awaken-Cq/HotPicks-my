<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 <mapper namespace="com.kitri.hotpicks.mypicks.dao.MypickMapDao">
 	<select id="getMapList" resultType="mapContentsDto">
 		select contentsid, subject, x, y, cate
 		from contents
 	</select>
 	<select id="selectContentsList" parameterType="map" resultType="mapContentsDto">
 	<![CDATA[
      select * from (
		select contentsid, subject, x, y, cate , to_char(DISTNACE_GRS80(#{x},#{y},x,y),'999,999,999.999') distance
 		from contents)
 		where
	 ]]>
 	<if test="selectMarkers.size() != 0">
 		contentsid in
 		<foreach collection="selectMarkers" item="selectMarker" open="(" separator="," close=")" >
 		#{selectMarker} 
 		</foreach>
		and
 	</if>
 	 
 		<![CDATA[
 		distance <= #{distance}/1000
        order by distance
        ]]>
 	</select>
 </mapper>
 