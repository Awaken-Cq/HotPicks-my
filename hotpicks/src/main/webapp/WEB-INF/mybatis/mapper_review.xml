<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 <mapper namespace="com.kitri.hotpicks.contents.dao.ReviewDao">
 	
 	<insert id="writeArticle" parameterType="reviewDto">
	insert all
		into review (rseq, userId,contentsId,hashTag,subject,starPoint,content,logTime,saveFolder,orignPicture,savePicture)
		values (#{rseq}, #{userId}, #{contentsId}, #{hashTag}, #{subject}, #{starPoint}, #{content}, sysdate, #{saveFolder}, #{orignPicture},#{savePicture})
	select * from dual
	</insert>
	
	<select id="getHashTag" parameterType="map" resultType="hashTagDto">
	select * from hashtag
	where rseq = #{rseq} and hashtag = #{hashtag}
	</select>
	
	<update id="updHashList" parameterType="map">
		<if test="hashList.size() != 0">
		<foreach collection="hashList" item="item" index="index">
		update hashtag
		set tagcount = #{item.tagCount} + 1
		where hashtag = #{item.hashTag} and rseq = #{item.rseq} 
		</foreach>
		</if>
	</update>
	
	<insert id="insHashList" parameterType="map">
	<if test="nonHashList.size() != 0">
	insert all
	
	<foreach collection="nonHashList" item="item" separator=" ">
	into hashtag (hashTag, rseq, contentsid,logtime)
	values (#{item},#{rseq} ,#{contentsid},sysdate)
	</foreach>
	select * from dual
	</if>
	</insert>
 </mapper>